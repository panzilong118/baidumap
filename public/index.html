<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="UTF-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
<title>加载海量点</title>

<style type="text/css">
	body, html,#allmap {width: 100%;height: 100%;overflow: hidden;margin:0;font-family:"微软雅黑";}
</style>
<link href="http://api.map.baidu.com/library/TrafficControl/1.4/src/TrafficControl_min.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=FWcG6V4ZQlq4AviVD9rkOzhmi02Awci4"></script>
<script type="text/javascript" src="http://api.map.baidu.com/library/TrafficControl/1.4/src/TrafficControl_min.js"></script>
</head>

<body>
  <div id="allmap"></div>

<script type="text/javascript">
	// 百度地图API功能
	var map = new BMap.Map("allmap");
	// 北京
	// var point = new BMap.Point(116.404, 39.915);
	// 南通 120.86, 32.01
	var point = new BMap.Point(120.86, 32.01);
	map.centerAndZoom(point, 15);
	map.enableScrollWheelZoom(true);

	//西什库大街	15
	var mock1 = `39.9239398871528 116.378855794271,39.9237771267361 116.378840060764,39.9236707899306 116.378836534288,39.9226456705729 116.37888156467`;
	//西什库大街	1
	var mock2 = `39.9289876302083 116.379818522135,39.9281640625 116.379904242622,39.927805718316 116.37993625217`;
	//首都体育馆南路
	var mock3 = `39.9348711480035 116.325673014323,39.9349956597222 116.325673014323,39.9350341796875 116.325671657986`;
	// 知春路
	var mock4 = `39.9765681966146 116.354291178385,39.9765700954861 116.353389756944`;

	//南通北枢纽	6
	var mock5 = `32.089643690321225 120.9103348795571,32.09006496853303 120.9105635579431,32.090266520182325 120.9107249620221,32.090394829644126 120.9108372667101,32.09058987087673 120.9110399034291,32.09076917860243 120.91126641167511,32.09094089084202 120.91153171115411,32.09172132703992 120.91293416341188,32.091939968533026 120.91334377712687,32.09204142252602 120.91362481011288,32.09211195203993 120.91388631184887,32.09214633517796 120.91413146972631,32.09216871473524 120.91445536295531,32.09218607584634 120.91538282606332`;
	// 南通北枢纽	6
	var mock6 = `32.089643690321225 120.9103348795571,32.091000027126725 120.9106810167101,32.09198147243923 120.9109213595921,32.09216512044273 120.9109604220921`;
	//南通北枢纽	8
	var mock7 = `32.092997707790786 120.91204026963956,32.09320651584203 120.91249688042487,32.09325615776912 120.91260647243888,32.093301730685724 120.91268893771687,32.093336995442726 120.91274427625888,32.09338256835943 120.91280476887988,32.093428955078124 120.91285413953989,32.09347452799483 120.91289754231789,32.09353203667533 120.91294121636287,32.09358276367182 120.91296888563389,32.09364732530382 120.91300035264788,32.09371676974823 120.91302341037289,32.09377861870662 120.91303127712689,32.09384806315103 120.91304131401887,32.09390719943572 120.91303127712689,32.09396118164062 120.91302856445287,32.09400756835943 120.91301581488688,32.09406914605033 120.91300035264788,32.09414347330733 120.91296698676189,32.09421291775172 120.91292060004389,32.094277208116324 120.91285359700487,32.09433634440103 120.91279961479987,32.09437757703992 120.91273776584188,32.09442396375873 120.91265801323789,32.09445949978303 120.91257310655388,32.09449557834202 120.91247029622389,32.09450588650172 120.91240844726588,32.094521348741324 120.91231811523488,32.09451863606772 120.9122486707899,32.094511650933185 120.91216193305144,32.09449890136719 120.91209004720042,32.09447530110678 120.91200242784242,32.094447089301184 120.91191724989142,32.094418877495684 120.91185689290356,32.09436218261719 120.91177469889357,32.09431850857209 120.91170769585455,32.09425665961369 120.91164611816455,32.09417446560329 120.91156609429257,32.094058024088525 120.91149210612011,32.09389879014752 120.91140448676211,32.09367173936633 120.9112924533421`;
	//南通北枢纽	8
	var mock8 = `32.09216512044273 120.9109604220921,32.093211941189224 120.91119723849809,32.09367173936633 120.9112924533421`;

	var mocks = [
		{
			id: 1,
			mock: mock5,
			status: 1
		},
		{
			id: 2,
			mock: mock6,
			status: 2
		},
		{
			id: 3,
			mock: mock7,
			status: 3
		},
		{
			id: 4,
			mock: mock8,
			status: 1
		}
	];

	// data = [
	// 	{
	// 		id: 1,
	// 		data: [],
	// 		status: 1
	// 	},
	// 	{}
	// ]
	var data = [];
	for(var j=0; j<mocks.length; j++){
		var arr = mocks[j].mock.split(',');
		for(var i =0; i<arr.length; i++){
			var obj = {
				lng: arr[i].substring(arr[i].indexOf(' ')+1, arr[i].length), // 经度
				lat: arr[i].substring(0, arr[i].indexOf(' ')) // 纬度
			}
			console.log(obj, '<---obj');
			if (data[j]) {
				data[j].push(obj);
			} else {
				data[j] = [];
				data[j].push(obj);
			}

		}
	}
	console.log(data, '<---data');

	// var data = [
	// 	{
	// 		lng: 116.399, // 经度
	// 		lat: 39.910 // 纬度
	// 	},
	// 	{
	// 		lng: 116.405,
	// 		lat: 39.920
	// 	},
	// 	{
	// 		lng: 116.425,
	// 		lat: 39.900
	// 	},
	// ];

	for(var i=0; i<data.length; i++){
		var points = [];
		var status = mocks[i].status;
		var color = 'red';
		if(status === '1' ){
			color = 'green';
		}else if (status === '2'){
			color = 'yellow';
		}else{
			color = 'red';
		}
		for(var j=0; j<data[i].length; j++){
			points.push(new BMap.Point(data[i][j].lng, data[i][j].lat))
		}
		console.log(points, '<---points');
		var polyline = new BMap.Polyline(points, {strokeColor:color, strokeWeight:20, strokeOpacity:0.5});   //创建折线
		map.addOverlay(polyline); //增加折线
	}

</script>

</body>

</html>
